<div class="bg-secondary w-100 h-auto rounded-2xl py-5 px-5 relative" >
    <div class="post-profile mb-3 flex gap-2 items-center">
        <div>
            <img class="w-10 h-10 rounded-full" [src]="postdata.user?.profileimg" alt="Rounded avatar">
        </div>
        <div class=" flex flex-col">
            <span class="font-semibold dark:text-white"> {{postdata.user?.username}}</span>
            <span class="dark:text-white text-xs">{{postdata.place}}</span>
        </div>
        @if(!postdata.same_user) {
        <div class="font-medium text-xs text-white bg-blue-600 px-2 py-1 rounded-lg flex cursor-pointer ">
            @if (postdata.isFollowing) {
            <span (click)="unfollow(postdata.creator_id)">Unfollow</span>
            }@else{
            <span (click)="follow(postdata.creator_id)">Follow</span>
            }
        </div>
        }

    </div>
    <div class="image-container" (dblclick)="like(postdata._id)">
        <!-- <img [src]="postdata.images[0]" alt="" > -->
        <swiper-container navigation="true" pagination="true">
            @for (image of postdata.images; track image) {
            <swiper-slide>
                <img [src]="image" alt="">
            </swiper-slide>
            }
        </swiper-container>
    </div>
    <div class="flex flex-col p-2 relative" >
        <div class="likes flex flex-col"  
          
        >
            <span class="font-medium text-sm dark:text-white" (click)="showLikedUsersModal()"
            (mouseenter)="showPopover()" 
            (mouseleave)="hidePopover()"
            >
            {{postdata.likes}} Likes</span>
            <span class="font-medium text-sm dark:text-white"> {{postdata.likedUsers | likesWithMutual}}</span>
            
        </div>


        <!-- Popover -->
        <div #popover id="popover" class="popover invisible opacity-0 absolute z-50 bottom-40  inline-block w-44 text-sm text-gray-500 transition-opacity duration-300 bg-white border border-gray-200 rounded-lg shadow-sm  dark:text-gray-400 dark:border-gray-600 dark:bg-gray-800">
            <div class="px-3 py-2 bg-gray-100 border-b border-gray-200 rounded-t-lg dark:border-gray-600 dark:bg-gray-700">
                <h3 class="font-semibold text-gray-900 dark:text-white">Liked By</h3>
            </div>
            <div class="px-3 py-2">
                @for (users of postdata.likedUsers; track users._id) {
                    <div class="flex gap-2 mb-1">
                        <div class="bg-gray-500 rounded-full">
                            @if (users.profileimg) {
                                <img class="w-5 h-5 rounded-full " [src]="users.profileimg" alt="">
                            }@else {
                                <img class="w-5 h-5 rounded-full "  alt="">
                                
                            }
                        </div>
                        <div>
                            <p>{{users.username}}</p>
                        </div>
                    </div>
                  
                }
            </div>
            <div data-popper-arrow></div>
        </div>
        <!-- Popover -->



        <div class="flex justify-between">
            <div class="flex gap-2">
                @if (postdata.isLiked) {
                <i class="fa-solid fa-heart text-xl cursor-pointer " (click)="unlike(postdata._id)"
                    style="color: #fe0606; "></i>
                }@else {
                <i class="fa-regular fa-heart text-xl cursor-pointer transition-all active:scale-125"
                    (click)="like(postdata._id)" style="color: #000000;"></i>
                }
                <i class="fa-regular fa-comment text-xl cursor-pointer text-black dark:text-gray-400"
                    (click)="onComment(postdata._id)"></i>
                <i class="fa-solid fa-share text-xl cursor-pointer text-black dark:text-gray-400"
                    (click)="onShare(postdata._id)"></i>
            </div>
            <div>
                @if (postdata.isSaved) {
                <i class="fa-solid fa-bookmark text-xl cursor-pointer text-black dark:text-gray-400"
                    (click)="onUnsave(postdata._id)"></i>
                }@else {
                <i class="fa-regular fa-bookmark text-xl cursor-pointer text-black dark:text-gray-400"
                    (click)="onSave(postdata._id)"></i>
                }
            </div>
        </div>
        <div class="dark:text-white">{{postdata.caption}}</div>
        @if (postdata.comments.length) {
            <div class="dark:text-white">{{postdata.comments.length}} comments</div>
        }
        <div class="dark:text-white text-xs">{{postdata.createdAt | dateFormat}}</div>

    </div>
</div>
